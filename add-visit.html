<!DOCTYPE HTML>
<html>
    <head>
        <meta charset="UTF-8">
        <title>Meeter - portal dla wszystkich oprócz Amerykanów</title>
        <link rel="stylesheet" href="styles.css">
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" />
        <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" />
        <link href="https://fonts.googleapis.com/css2?family=Patrick+Hand&display=swap" rel="stylesheet">
    </head>
    <body>
        <header>
            Baza danych spotkań
        </header>
        <div class="container">
            <nav class="left-menu">
            </nav>
            <div id="main">
                <form>
                    <h2 class="inputHeader">Data wizyty</h2>
                    <input type="datetime-local" id="visitDateInput"/>
                    <h2 class="inputHeader">Czas trwania wizyty</h2>
                    <input type="number" value="1" id="visitDaysNumber"/>
                    <h2 class="inputHeader">Krótki opis wizyty</h2>
                    <input type="text" id="inputShortDescInput"/>
                    <h2 class="inputHeader">Długi opis wizyty</h2>
                    <textarea id="inputLongDescInput" rows=20 cols=95></textarea>
                    <h2 class="inputHeader">Wybierz gości</h2>
                    <input type="text" id="searchedHumanInput" onkeyup="createGuestsTilesFromName()" placeholder="Wyszukaj gościa..."/>
                    <div id="suggestedGuestsContainer">

                    </div>
                    <h2 class="inputHeader">Wybrani goście</h2>
                    <div id="chosenGuestsContainer">

                    </div>
                    <button>Dodaj wizytę!</button>
                </form>

            </div>
            <aside class="right-menu">
                <!-- Right menu content goes here -->
            </aside>
        </div>
    </body>
    <script src="createLeftMenu.js" ></script>
    <script>
        createLeftMenu()
        function clearSuggestedGuests() {
            let suggestedGuestsContainer = document.getElementById("suggestedGuestsContainer")
            suggestedGuestsContainer.innerHTML = ""
        }

        async function createGuestsTilesFromName() {
            let deliveredInput = document.getElementById("searchedHumanInput").value
            if (deliveredInput.length > 2) {
                clearSuggestedGuests()
                const guestCandidatesReq = await fetch(`http://localhost:3000/get-human-from-substring?name_fragment=${deliveredInput}`)
                const guestCandidates = await guestCandidatesReq.json()
                createHumanTiles(guestCandidates)
            }
        }
        function createHumanTiles(arrayOfHumans) {
            let suggestedGuestsContainer = document.getElementById("suggestedGuestsContainer")
            for (human of arrayOfHumans) {
                    let newHumanTile = document.createElement("div")
                    newHumanTile.setAttribute("class", "human_tile_in_add_visit")
                    newHumanTile.setAttribute("id", `humanTile-${human.id}`)
                    suggestedGuestsContainer.appendChild(newHumanTile)

                    let guestPhoto = document.createElement("img")
                    guestPhoto.setAttribute("src", human.photoDir)
                    guestPhoto.setAttribute("class", "person_photo")
                    newHumanTile.appendChild(guestPhoto)

                    let guestName = document.createElement("div")
                    guestName.setAttribute("class", "nameDiv")
                    guestName.innerText = human.name
                    newHumanTile.appendChild(guestName)
                }
        }
    </script>
</html>